# Импорт вопросов и ответов к опроснику из CSV

## Описание

Эта команда позволяет импортировать вопросы и варианты ответов для конкретного опросника из CSV файла.

## Использование

```bash
python manage.py import_questions <survey_id> path/to/questions.csv
```

### Примеры

```bash
# Импорт вопросов для опросника с ID 1
python manage.py import_questions 1 questions.csv

# Импорт вопросов для опросника с ID 3
python manage.py import_questions 3 apps/surveys/management/commands/templates/questions_import_template.csv
```

## Структура CSV файла

### Обязательные поля

- **question_order** - Порядковый номер вопроса в опроснике (уникальный)
- **question_type** - Тип вопроса:
  - `single` - Одиночный выбор (только один правильный ответ)
  - `multiple` - Множественный выбор (несколько правильных ответов)
  - `open` - Открытый вопрос (без вариантов ответов)
- **text_uz** - Текст вопроса на узбекском языке (латиница)

### Опциональные поля

- **text_uz_cyrl** - Текст вопроса на узбекском языке (кириллица)
- **text_ru** - Текст вопроса на русском языке
- **points** - Количество баллов за правильный ответ (по умолчанию: 1)
- **is_active** - Активен ли вопрос (`true`/`false`, по умолчанию: `true`)
- **work_domain** - Домен работы:
  - `natural_gas` - Природный газ
  - `lpg_gas` - Сжиженный газ
  - `both` - Оба домена
  - (пустое) - Для всех доменов
- **category** - Категория вопроса:
  - `safety_logic_psychology` - Безопасность, Логика (IQ), Психология
  - `other` - Другое (по умолчанию)

### Поля для вариантов ответов

Для вопросов типа `single` и `multiple` можно указать до 4 вариантов ответов:

- **choice_N_text_uz** - Текст варианта на узбекском (латиница)
- **choice_N_text_uz_cyrl** - Текст варианта на узбекском (кириллица)
- **choice_N_text_ru** - Текст варианта на русском
- **choice_N_is_correct** - Правильный ли ответ (`true`/`false`)

Где N - номер варианта (1, 2, 3, 4).

## Пример CSV файла

```csv
question_order,question_type,text_uz,text_uz_cyrl,text_ru,points,is_active,work_domain,category,choice_1_text_uz,choice_1_text_uz_cyrl,choice_1_text_ru,choice_1_is_correct,choice_2_text_uz,choice_2_text_uz_cyrl,choice_2_text_ru,choice_2_is_correct
1,single,"Какие основные правила техники безопасности?","Техника хавфсизлигининг асосий қоидалари қандай?","Какие основные правила техники безопасности?",2,true,natural_gas,safety_logic_psychology,"Всегда проверять герметичность","Ҳамеша герметикликни текшириш","Всегда проверять герметичность",true,"Использовать открытый огонь","Очиқ оловдан фойдаланиш","Использовать открытый огонь",false
2,multiple,"Какие действия при утечке газа?","Газ утечкасида қандай харакатлар?","Какие действия при утечке газа?",3,true,natural_gas,safety_logic_psychology,"Перекрыть газ","Газни ёпиш","Перекрыть газ",true,"Проветрить помещение","Бинолни хаволаштириш","Проветрить помещение",true,"Вызвать аварийную службу","Аварий хизматни чақириш","Вызвать аварийную службу",true,"Зажечь спичку","Гўшт ўчқочини ёқиш","Зажечь спичку",false
3,open,"Опишите процедуру запуска оборудования","Оборудованиени ишга тушириш тартибини тавсифланг","Опишите процедуру запуска оборудования",2,true,natural_gas,other,,,,,,,,,,,,,,,,,,
```

## Особенности

1. **Обновление существующих вопросов**: Если вопрос с таким `question_order` уже существует, он будет обновлен
2. **Варианты ответов**: Для существующих вопросов все варианты ответов удаляются и создаются заново
3. **Валидация типов вопросов**: Неверные типы автоматически заменяются на `single`
4. **Многоязычность**: Поддерживается узбекский (латиница и кириллица) и русский языки
5. **Транзакции**: Все операции выполняются в транзакции для обеспечения целостности

## Шаблоны

- `questions_import_template.csv` - Базовый шаблон с примерами
- `questions_import_template_detailed.csv` - Подробный шаблон с комментариями

## Ошибки и предупреждения

- Строки без `text_uz` пропускаются с предупреждением
- Некорректные значения полей вызывают ошибку для конкретной строки
- Ошибки в одной строке не останавливают обработку остальных строк
- Неверные типы вопросов автоматически исправляются

## Рекомендации

1. **Порядок вопросов**: Используйте последовательные номера для `question_order`
2. **Варианты ответов**: Для `single` вопросов только один ответ должен быть правильным
3. **Множественный выбор**: Для `multiple` вопросов может быть несколько правильных ответов
4. **Открытые вопросы**: Для `open` вопросов не указывайте варианты ответов
5. **Категории**: Правильно указывайте категории для корректного распределения вопросов
